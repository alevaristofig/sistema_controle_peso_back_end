package com.sistemacontrolepeso.api.controller;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayNameGeneration;
import org.junit.jupiter.api.DisplayNameGenerator;
import org.junit.jupiter.api.Nested;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.Spy;
import org.mockito.junit.jupiter.MockitoExtension;

import com.sistemacontrolepeso.domain.model.Peso;
import com.sistemacontrolepeso.domain.service.CadastroPesoService;
import com.sistemacontrolepeso.model.PesoTestData;

@DisplayNameGeneration(DisplayNameGenerator.ReplaceUnderscores.class)
@ExtendWith(MockitoExtension.class)
public class PesoControllerTest {
	
	@Mock
	CadastroPesoService pesoService;

	@Nested
	class CadastroComPesoValido{
		
		@Spy
		Peso peso = PesoTestData.umNovoPeso();
		
		@BeforeEach
		void init() {
			Mockito.when(pesoService.salvar(Mockito.any(Peso.class)))
					.thenAnswer(invocacao -> {
						Peso pesoPassado = invocacao.getArgument(0,Peso.class);
						pesoPassado.setId(1L);
						return pesoPassado;
					});			
		}
	}
}
